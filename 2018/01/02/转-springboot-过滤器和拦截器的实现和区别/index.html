<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="KIWI,kiwiflydream@gmail.com"><title>[转] springboot 过滤器和拦截器的实现和区别 · 求索之路</title><meta name="description" content="本文由 简悦 SimpRead 转码， 原文地址 https://segmentfault.com/a/1190000012072060

前言springmvc 中有两种很普遍的 AOP 实现：1. 过滤器（Filter）2. 拦截器（Interceptor）
本篇面对的是一些刚接触 spring"><meta name="keywords" content="Hexo,HTML,CSS,java,Linux,code,spring"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><link rel="stylesheet" href="/css/prism-ghcolors.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">求索之路</a></h3><div class="description"><p>路漫漫其修远兮，吾将上下而求索</p></div></div></div><ul class="social-links"><li><a href="http://weibo.com/1761079264"><i class="fa fa-weibo"></i></a></li><li><a href="http://github.com/kiwiflydream"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">Home</a></li><li><a href="/about">Sobre</a></li><li><a href="/archives">Arquivo</a></li><li><a href="/links">Links</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="https://avatars2.githubusercontent.com/u/13311001"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>[转] springboot 过滤器和拦截器的实现和区别</a></h3></div><div class="post-content"><blockquote>
<p>本文由 <a href="http://ksria.com/simpread/" target="_blank" rel="external">简悦 SimpRead</a> 转码， 原文地址 <a href="https://segmentfault.com/a/1190000012072060" target="_blank" rel="external">https://segmentfault.com/a/1190000012072060</a></p>
</blockquote>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>springmvc 中有两种很普遍的 AOP 实现：<br>1. 过滤器（Filter）<br>2. 拦截器（Interceptor）</p>
<p>本篇面对的是一些刚接触 springboot 的人群<br>所以主要讲解 filter 和 interceptor 的简单实现和它们之间到底有什么区别<br>（一些复杂的功能我会之后发出文章，请记得关注）</p>
<h2 id="Filter-的简单实现"><a href="#Filter-的简单实现" class="headerlink" title="Filter 的简单实现"></a>Filter 的简单实现</h2><p>字面意思：过滤器就是过滤的作用，在 web 开发中过滤一些我们指定的 url<br>那么它能帮我们过滤什么呢？<br>那功能可就多了：<br>比如过拦截掉我们不需要的接口请求<br>修改请求（request）和响应（response）内容<br>完成 CORS 跨域请求等等</p>
<p>现在我们来实现一个简单的过滤器：<br>可以新建一个 filter 包，随着项目的扩大过滤器会越来越多<br>在这里我新建了一个<code>TestFilter</code>类，实现 Filter 接口</p>
<pre><code>@Component
@WebFilter(urlPatterns = &quot;/Blogs&quot;,filterName = &quot;blosTest&quot;)
public class TestFilter implements Filter{}
</code></pre><p>我们一步步来<br>1.@Component 就是把这个类注入到 IOC 容器中<br>2.@WebFilter(urlPatterns = “/Blogs”,filterName = “blosTest”) 说明这是一个 web 过滤器，它拦截的 url 为<code>/Blogs</code>，过滤器名字为<code>blogsTest</code></p>
<p>下面贴出实现接口之后的三个重构方法：</p>
<pre><code>@Override
    public void init(FilterConfig filterConfig) throws ServletException {

    }

    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {
        HttpServletRequest request= (HttpServletRequest) servletRequest;
        HttpServletResponse response = (HttpServletResponse) servletResponse;
        System.out.printf(&quot;过滤器实现&quot;);
        filterChain.doFilter(request,response);
    }

    @Override
    public void destroy() {

    }
</code></pre><p>初始化（init）和摧毁（destroy）方法一般不会用到，具体使用看下源码便知<br>doFilter（）是过滤器的核心<br>注意：在实现接口方法之后，我们要转换 request 和 response 类型至 HttpServlet，否则接下去的操作可能会报错。<br>如果过滤通过，执行<code>filterChain.doFilter(request,response);</code><br>说明这个 url 已经经过了我们的 Filter<br>其他不要设置，我们执行看下结果：</p>
<p><img src="https://segmentfault.com/img/bVYOwA?w=806&amp;h=168" alt=""></p>
<p><img src="https://segmentfault.com/img/bVYOwD?w=708&amp;h=182" alt=""></p>
<p>可以看到，只需要一个类我们就实现了一个简单的过滤器</p>
<p>当然可以不用注解的方式，配置启动类</p>
<pre><code>//过滤器
    @Bean
    public FilterRegistrationBean filterRegistrationBean(){
        FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean();
        List&lt;String&gt; urlPatterns = new ArrayList&lt;String&gt;();

        TestFilter testFilter = new TestFilter();   //new过滤器
        urlPatterns.add(&quot;/Blogs&quot;);      //指定需要过滤的url
        filterRegistrationBean.setFilter(testFilter);       //set
        filterRegistrationBean.setUrlPatterns(urlPatterns);     //set

        return filterRegistrationBean;
    }
</code></pre><p>这也是可以的，本人其实还是比较推荐这种方式添加过滤器</p>
<h2 id="Interceptor-的简单实现"><a href="#Interceptor-的简单实现" class="headerlink" title="Interceptor 的简单实现"></a>Interceptor 的简单实现</h2><p>拦截器的实现比过滤器稍微复杂一点<br>我们同样可以新建一个 interceptor 包<br>在里面新建一个名为<code>MyInterceptor</code>的类</p>
<pre><code>public class MyInterceptor implements HandlerInterceptor {}
</code></pre><p>这个类实现了<code>HandleInterceptor</code>接口<br>直接贴类代码，我会在代码中注释功能</p>
<pre><code>public class MyInterceptor implements HandlerInterceptor {
    //在请求处理之前进行调用（Controller方法调用之前
    @Override
    public boolean preHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o) throws Exception {
        System.out.printf(&quot;preHandle被调用&quot;);
        return true;    //如果false，停止流程，api被拦截
    }

    //请求处理之后进行调用，但是在视图被渲染之前（Controller方法调用之后）
    @Override
    public void postHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView) throws Exception {
        System.out.println(&quot;postHandle被调用&quot;);
    }

    //在整个请求结束之后被调用，也就是在DispatcherServlet 渲染了对应的视图之后执行（主要是用于进行资源清理工作）
    @Override
    public void afterCompletion(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e) throws Exception {
        System.out.println(&quot;afterCompletion被调用&quot;);
    }
}
</code></pre><p>它依次实现了三个方法<br>相比过滤器，拦截器还需要在 springmvc 中注入<br>所以我们打开启动类，写入以下代码</p>
<pre><code>public class WarApplication {

    public static void main(String[] args) {
        SpringApplication.run(WarApplication.class, args);
    }

    //mvc控制器
    //@Configuration
    static class WebMvcConfigurer extends WebMvcConfigurerAdapter{
        //增加拦截器
        public void addInterceptors(InterceptorRegistry registry){
            registry.addInterceptor(new MyInterceptor())    //指定拦截器类
                    .addPathPatterns(&quot;/Handles&quot;);        //指定该类拦截的url
        }
    }
}
</code></pre><p>这里我在<code>/Handles</code>这个 url 中进行拦截<br>代码写完了，来看下结果</p>
<p><img src="https://segmentfault.com/img/bVYOyA?w=722&amp;h=200" alt=""></p>
<p><img src="https://segmentfault.com/img/bVYOyI?w=652&amp;h=194" alt=""></p>
<p>当进入指定 url 时，我们执行到了拦截器<br>接下来就可以根据需求去使用拦截器了</p>
<h2 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h2><p>过滤器和拦截器非常相似，但是它们有很大的区别<br>最简单明了的区别就是<strong>过滤器可以修改 request，而拦截器不能</strong><br><strong>过滤器需要在 servlet 容器中实现，拦截器可以适用于 javaEE，javaSE 等各种环境</strong><br><strong>拦截器可以调用 IOC 容器中的各种依赖，而过滤器不能</strong><br><strong>过滤器只能在请求的前后使用，而拦截器可以详细到每个方法</strong><br>区别很多，大家可以去查下</p>
<p>总的来说<br>过滤器就是筛选出你要的东西，比如 requeset 中你要的那部分<br>拦截器在做安全方面用的比较多，比如终止一些流程<br>网上有一张图片很不错，这里拷过来给大家看一下</p>
<p><img src="https://segmentfault.com/img/bVYOEG?w=1392&amp;h=808" alt=""></p>
<p><strong>以上便是 springboot 中过滤器和拦截器的实现和区别；</strong><br><strong>觉得还可以的请点个赞，赞不了也可以收藏下；</strong><br><strong>总之，谢谢阅读～</strong></p>
<p>本文地址 <a href="https://blog.coder4j.cn/2018/01/02/转-springboot-过滤器和拦截器的实现和区别/">https://blog.coder4j.cn/2018/01/02/转-springboot-过滤器和拦截器的实现和区别/</a> </p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-01-02</span><i class="fa fa-tag"></i><a class="tag" href="/categories/转载/" title="转载">转载 </a><a class="tag" href="/categories/转载/spring-boot/" title="spring boot">spring boot </a><a class="tag" href="/tags/spring-boot/" title="spring boot">spring boot </a><a class="tag" href="/tags/过滤器/" title="过滤器">过滤器 </a><a class="tag" href="/tags/拦截器/" title="拦截器">拦截器 </a><a class="tag" href="/tags/web/" title="web">web </a><a class="tag" href="/tags/转载/" title="转载">转载 </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,https://blog.coder4j.cn/2018/01/02/转-springboot-过滤器和拦截器的实现和区别/,求索之路,[转] springboot 过滤器和拦截器的实现和区别,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2018/01/06/转-为什么年轻时要多赚钱？/" title="[转]为什么年轻时要多赚钱？">Post Anterior</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/01/01/使用-docker-光速安装-gitlab/" title="使用 docker 光速安装 gitlab">Próximo post</a></li></ul></div><a id="comments"></a><div id="vcomments" style="margin:0 30px;"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/gh/xcss/valine@v1.1.7/dist/Valine.min.js?v=undefined"></script><script>var valine = new Valine({
  el:'#vcomments',
  notify:false || false, 
  verify:false|| false, 
  app_id:'8yC4X3BzOzeAMrSi2SrEwbMc-gzGzoHsz',
  app_key:'M6soikk87YmsFLtgwu6vVqed',
  placeholder:'ヾﾉ≧∀≦)o来啊，快活啊!',
  path: window.location.pathname,
  avatar:'wavatar'
})</script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>